{% extends 'base.html' %}

{% block content %}
<div class="min-h-[100dvh]">
    <!-- SIDEBAR -->
    <menu class="fixed h-screen w-20 lg:w-74 pt-6 px-4 lg:px-5.5 border-r border-neutral-200 dark:border-neutral-700 flex flex-col">
        <div>
            <a class="flex items-center gap-4 mb-6" href="">
                <svg class="h-9 text-primary mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64l256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64L64 448c-35.3 0-64-28.7-64-64L0 128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2l0 256c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1l0-17.1 0-128 0-17.1 14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z"/></svg>
                <h1 class="hidden text-primary lg:inline-block">Vidster</h1>
            </a>
            <a class="menu-item" href="">
                <svg class="h-5 mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>
                <h3 class="hidden lg:inline-block">Home</h3>
            </a>
            <a class="menu-item" href="">
                <svg class="h-5 mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
                <h3 class="hidden lg:inline-block">Search</h3>
            </a>
            <a class="menu-item" href="">
                <svg class="h-5 mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm50.7-186.9L162.4 380.6c-19.4 7.5-38.5-11.6-31-31l55.5-144.3c3.3-8.5 9.9-15.1 18.4-18.4l144.3-55.5c19.4-7.5 38.5 11.6 31 31L325.1 306.7c-3.2 8.5-9.9 15.1-18.4 18.4zM288 256a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></svg>               
                <h3 class="hidden lg:inline-block">Explore</h3>
            </a>
            <a class="menu-item" href="">
                <svg class="h-5 mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M288 109.3L288 352c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-242.7-73.4 73.4c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l128-128c12.5-12.5 32.8-12.5 45.3 0l128 128c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L288 109.3zM64 352l128 0c0 35.3 28.7 64 64 64s64-28.7 64-64l128 0c35.3 0 64 28.7 64 64l0 32c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64l0-32c0-35.3 28.7-64 64-64zM432 456a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"/></svg>
                <h3 class="hidden lg:inline-block">Upload</h3>
            </a>
        </div>
        <div class="mt-auto mb-4">
            {% if user.is_authenticated %}
            <a class="menu-item" href="">
                <svg class="h-5 mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"/></svg>
                <h3 class="hidden lg:inline-block">Profile</h3>
            </a>
            {% else %}
            <a class="menu-item" href="{% url 'auth_home' %}">
                <svg class="h-5 mx-auto lg:mx-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M217.9 105.9L340.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L217.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1L32 320c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM352 416l64 0c17.7 0 32-14.3 32-32l0-256c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32l64 0c53 0 96 43 96 96l0 256c0 53-43 96-96 96l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
                <h3 class="hidden lg:inline-block">Login</h3>
            </a>
            {% endif %}
        </div>
    </menu>

    <!-- <main class="ml-20 lg:ml-[18.5rem] md:mr-20 p-4"> -->
    <main class="ml-20 lg:ml-[18.5rem] md:mr-20 p-4">
        <div class="grid grid-col lg:grid-cols-2 xl:grid-cols-3 gap-4">
            {% for item in media %}
            <a data-embed-url="{{ item.embed_url }}" class="relative aspect-video overflow-hidden rounded-lg">
                <img class="w-full" src="{{ item.thumbnail_url }}" alt="">
                <div class="absolute bottom-0 bg-black/50 bg-opacity-50 w-full p-2 text-white">
                    <h3 class="truncate-title" title="{{ item.title }}">{{ item.title }}</h3>
                </div>
            </a>
                            <iframe
                    class="w-full h-full"
                    src="{{ item.embed_url }}"
                    frameborder="0"
                    allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen>
                </iframe>
            {% endfor %}
        </div>
    </main>



<!-- RIGHT SIDEBAR -->
<aside class="md:fixed right-0 top-0 h-screen w-20 z-10 flex flex-col justify-end pl-4 py-4 border-l border-neutral-200 dark:border-neutral-700">
    <button id="scrollButton" class="size-12 rounded-full bg-neutral-100 dark:bg-neutral-700 hover:bg-neutral-200 dark:hover:bg-neutral-800 cursor-pointer flex items-center justify-center hidden">
        <div class="size-6">
            <svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="m24 20.24 13.17 13.17a1 1 0 0 0 1.42 0l2.82-2.82a1 1 0 0 0 0-1.42L25.06 12.82a1.5 1.5 0 0 0-2.12 0L6.59 29.17a1 1 0 0 0 0 1.42L9.4 33.4a1 1 0 0 0 1.42 0L24 20.24Z"></path>
            </svg>
        </div>
    </button>
</aside>
</div>

<div id="videoModal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center hidden z-50">
    <button id="closeModal" class="absolute top-4 right-4 text-white text-2xl">&times;</button>
    <iframe id="videoPlayer" class="w-full h-full max-h-[100vh]" frameborder="0" allowfullscreen></iframe>
</div>

<script>
    const videoModal = document.getElementById('videoModal');
    const videoPlayer = document.getElementById('videoPlayer');
    const closeModal = document.getElementById('closeModal');

    // Handle thumbnail click
    document.querySelectorAll('[data-embed-url]').forEach(thumbnail => {
        thumbnail.addEventListener('click', (event) => {
            event.preventDefault(); // Prevent default link behavior
            const embedUrl = thumbnail.getAttribute('data-embed-url');
            videoPlayer.src = embedUrl; // Set the iframe source to the embed URL
            videoModal.classList.remove('hidden'); // Show the modal
        });
    });

    // Handle modal close
    closeModal.addEventListener('click', () => {
        videoModal.classList.add('hidden'); // Hide the modal
        videoPlayer.src = ''; // Clear the iframe source
    });

    // Close modal when clicking outside the iframe
    videoModal.addEventListener('click', (event) => {
        if (event.target === videoModal) {
            videoModal.classList.add('hidden');
            videoPlayer.src = '';
        }
    });
</script>

<script>
    const scrollButton = document.getElementById('scrollButton');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 100) {
            scrollButton.classList.remove('hidden');
        } else {
            scrollButton.classList.add('hidden');
        }
    });

    scrollButton.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
</script>

{% endblock %}